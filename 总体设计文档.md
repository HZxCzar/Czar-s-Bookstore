# 总体设计文档

## 功能设计

### 文件读写模块

* 实现预处理索引空间

* 读入写入索引indexblock

* 读入写入数据valueblock

### 数据结构管理模块

#### part A

* indexblock管理索引以及图书对应检索信息（ISBN）

* valueblock管理图书详细数据

#### part B

* memberblock管理用户用户名密码

* datablock管理用户购买等信息

#### part C

* nameblock管理员工

* workerblock管理员工操作数据

#### part D

* file_in管理进货

* file_out管理卖出

* file_money管理盈利情况

### 数据库模块

* 查询功能
  
  于链表寻找索引对象，找到后返回

* 插入指定值
  
  于链表寻找索引对象，找到后二分寻找数据位置并插入

* 删除指定值
  
  于链表寻找索引对象，找到后二分寻找数据位置并删除

* 修改指定值：
  
  于链表寻找并修改对应信息

### 盈利系统

负责通过数据库统计盈利信息

### 日志系统

负责通过数据库管理员工数据

### 游客系统

* 注册：向管理端发出申请

* 登录：输入登录信息，在partB寻找，若找到则可登入

### 顾客系统

* 查询图书：调用数据库模块的查询功能

* 购买图书：通过ISBN使用查询，并依据购买数额调用修改功能
  
  **/顾客购买图书会调用盈利系统**

### 销售人员系统

* 进货：通过ISBN调用查询，修改对应数据，若未找到则判定为第一次录入

* 第一次录入，添加新图书数据，完善各类信息（设定初值）

* 判断注册：确认新用户注册
  
  **/销售人员操作都要录入日志系统**
  
  **/销售人员进货会调用盈利系统**

### 店长系统

#### 调用销售人员系统

#### 调用顾客系统

* 通过盈利系统查询盈利情况
* 查看日志

## 用户交互设计

#### 游客

* 登录：输入用户名，密码；输出登录成功/失败。失败：用户名不存在/密码错误

* 注册：输入用户名，重复输入密码。注册成功/失败

#### 顾客

* 查询图书：根据 ISBN 号、作者名字、关键字、书名中的任意组合进行查询。输出未找到/ISBN号+作者名字+关键字+书名

* 购买图书：输入ISBN 号和购买数量，输出购买成功/购买失败（未找到对应书目，库存不足）

#### 销售人员

* 进货：输入指定 ISBN 号、数量、进货价格；输出进货成功（输出输入信息确认）

* 第一次录入：输出：“请输入各条图书信息：”，输入ISBN 号、作者名字、关键字、书名等

#### 店长

* 输入销售人员系统：进入销售系统

* 输入顾客系统：进入顾客系统

* 查询采购：输入时间段开始，结束；输出期间采购图书的 ISBN 号、数量、单价等

* 查询销售：按照销售顺序输出售出图书的 ISBN 号、数量、单价等

* 查询盈利：输出该段时间的收入，支出以及利润

* 查看日志：查看员工：输入员工：输出员工日志信息；查看整体：输出整体日志信息。

## 数据库设计

**使用块状链表，分为图书数据库、用户数据库、盈利数据库、日志数据库**

#### 图书数据库：

索引保存图书ISBN，书名，关键字，作者名；数据块存图书数量价格等信息；

#### 用户数据库：

索引储存用户名，用户类型，对应储存用户密码及可能的消费状况

#### 盈利数据库：

以时间段划分数据，根据指定时间区间搜索对应数据空间

#### 日志数据库

* 员工日志：根据员工为索引可查询对应员工操作

* 整体日志：根据时间为索引查询整体日志

### 类与结构体

#### 类

* 图书数据库类

* 用户数据库类

* 盈利数据库类

* 日志数据库类

* 文件读入读出类

* 块状链表处理类

结构体

* index节点struct

* value块struct
